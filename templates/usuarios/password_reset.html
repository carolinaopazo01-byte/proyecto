{% extends "base/public.html" %}
{% load static %}

{% block title %}Recuperar contraseña | Campeones Para Coquimbo{% endblock %}

{% block extra_css %}
<style>
  /* ===== Paleta y tipografía (idénticas al login) ===== */
  :root{
    --cpc-teal:   #056375;
    --cpc-navy:   #091236;
    --cpc-ivory:  #FAF9F8;
    --cpc-sea:    #A1B2AE;
    --tone-aqua:  #10A5AA;
    --tone-deep:  #0A5A64;
    --aqua-dark:  #0B5A66;
    --aqua-light: #D7F0F3;
    --ring:       rgba(5,99,117,.28);
    --hover-soft: rgba(16,165,170,.08);
  }

  /* Misma estructura visual que login */
  .pw-root{
    font-family: inherit;
    background: var(--cpc-ivory);
    margin: 0; padding: 0;
    min-height: calc(100vh - 180px);
    display: flex; align-items: flex-start; justify-content: center;
  }

  .pw-header{
    width: 100%;
    max-width: 840px;
    background: linear-gradient(90deg, var(--aqua-dark) 0%, var(--tone-deep) 100%);
    color: #fff;
    text-align: center;
    padding: 18px 16px;
    border-radius: 14px;
    box-shadow: 0 10px 22px rgba(0,0,0,.08);
    margin: 28px 16px 16px;
  }
  .pw-header h1{ margin:0; font-size: clamp(20px, 2.8vw, 28px); font-weight:800; letter-spacing:.2px; }
  .pw-header p{ margin:6px 0 0; opacity:.95; font-weight:600; }

  .pw-wrap{
    width: 100%; max-width: 520px;
    margin: 10px 16px 48px;
    background:#fff;
    padding: 26px;
    border-radius: 14px;
    border: 1px solid #eef2f7;
    box-shadow: 0 8px 18px rgba(0,0,0,.06);
  }

  .pw-label{
    display:block; font-weight:700; margin:10px 0 6px; color: var(--cpc-teal);
  }
  /* Estilo de inputs sin depender de tags extra */
  .pw-wrap input[type="email"],
  .pw-wrap input[type="text"]{
    width:100%;
    padding:12px;
    border:1px solid #cfd8e3;
    border-radius:10px;
    font-size:14px;
    background:#fff;
    transition: box-shadow .12s ease, border-color .12s ease, background .12s ease;
  }
  .pw-wrap input[type="email"]:focus,
  .pw-wrap input[type="text"]:focus{
    border-color: var(--cpc-teal);
    box-shadow: 0 0 0 .2rem var(--ring);
    outline: none;
  }

  .pw-btn{
    width:100%; margin-top:14px;
    display:inline-flex; justify-content:center; gap:8px; align-items:center;
    background: var(--cpc-teal); color:#fff; border:none;
    padding:12px; border-radius:10px; font-weight:800; cursor:pointer;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
  }
  .pw-btn:hover{ background:#045768; transform: translateY(-1px); box-shadow:0 10px 20px rgba(0,0,0,.08); }

  .pw-help{
    display:flex; justify-content:space-between; align-items:center; margin-top:10px; font-size:14px; gap:12px; flex-wrap:wrap;
  }
  .pw-help a{ text-decoration:none; color: var(--cpc-teal); font-weight:800; }
  .pw-help a:hover{ text-decoration: underline; }
  .pw-muted{ color:#6b7280; font-size:12px; }

  .alert{ margin-bottom:12px; border-radius:10px; }

  /* Responsivo como en login */
  @media (max-width: 420px){
    .pw-wrap{ padding:20px; }
    .pw-help{ flex-direction:column; align-items:flex-start; }
  }
</style>
{% endblock %}

{% block content %}
  <div class="pw-root">
    <div style="width:100%; display:flex; flex-direction:column; align-items:center;">
      <div class="pw-header">
        <h1>Campeones Para Coquimbo</h1>
        <p>Recuperar contraseña</p>
      </div>

      <div class="pw-wrap">
        {# Mensajes globales #}
        {% if messages %}
          {% for m in messages %}
            <div class="alert alert-{{ m.tags }}">{{ m }}</div>
          {% endfor %}
        {% endif %}

        {# Errores no asociados a campos #}
        {% if form.non_field_errors %}
          <div class="alert alert-danger mb-2">
            {% for e in form.non_field_errors %}{{ e }}{% if not forloop.last %}<br>{% endif %}{% endfor %}
          </div>
        {% endif %}

        {# ¡Sin action! Postea a la MISMA RUTA donde está montada la vista #}
        <form method="post" novalidate>
          {% csrf_token %}

          <label class="pw-label" for="{{ form.email.id_for_label }}">Correo electrónico</label>
          {{ form.email }}  {# render nativo, sin tags externos #}

          {% if form.email.help_text %}
            <div class="pw-muted" style="margin-top:.35rem">{{ form.email.help_text }}</div>
          {% else %}
            <div class="pw-muted" style="margin-top:.35rem">Usa el correo con el que te registraste.</div>
          {% endif %}
          {% if form.email.errors %}
            <ul class="errorlist" style="margin:.4rem 0 0; padding-left:1rem; color:#b91c1c; font-weight:700;">
              {% for e in form.email.errors %}<li>{{ e }}</li>{% endfor %}
            </ul>
          {% endif %}

          <button class="pw-btn" type="submit">
            <i class="fas fa-paper-plane"></i> Enviar enlace de recuperación
          </button>

          <div class="pw-help">
            <span class="pw-muted">¿Recordaste tu clave?</span>
            <a href="{% url 'usuarios:login_rut' %}">Volver a iniciar sesión</a>
          </div>
        </form>
      </div>
    </div>
  </div>
{% endblock %}
