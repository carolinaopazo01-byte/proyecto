<!doctype html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <title>{% block title %}Campeones para Coquimbo{% endblock %}</title>
    <style>
      body {
        font-family: system-ui, Arial, sans-serif;
        margin: 24px;
        background-color: #fafafa;
      }
      header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #003366;
        color: white;
        padding: 12px 20px;
        border-radius: 10px;
      }
      header h1 {
        margin: 0;
        font-size: 22px;
        letter-spacing: 0.5px;
      }
      nav a {
        color: white;
        text-decoration: none;
        margin-left: 16px;
        padding: 6px 10px;
        border-radius: 6px;
      }
      nav a:hover {
        background: rgba(255, 255, 255, 0.15);
      }
      .bar {
        display: flex;
        gap: 8px;
        align-items: center;
        margin: 16px 0;
      }
      .btn {
        padding: 8px 12px;
        border: 1px solid #ddd;
        border-radius: 6px;
        text-decoration: none;
        color: #222;
        background: #f0f0f0;
      }
      .btn:hover {
        background: #e2e2e2;
      }
      h2 {
        margin: 10px 0;
        color: #003366;
      }
      main {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      }
      /* --- Estilos para los mensajes --- */
      ul.messages {
        list-style: none;
        padding: 0;
        margin: 0 0 16px 0;
      }
      ul.messages li {
        border-radius: 6px;
        padding: 10px 14px;
        margin-bottom: 8px;
        font-weight: 500;
      }
      ul.messages li.error { background: #ffe3e3; color: #b00020; border: 1px solid #f5c2c2; }
      ul.messages li.success { background: #e6ffed; color: #0a661a; border: 1px solid #b7f0bf; }
      ul.messages li.warning { background: #fff6e3; color: #9c6b00; border: 1px solid #ffeb99; }
      ul.messages li.info { background: #e3f0ff; color: #004085; border: 1px solid #b8daff; }
    </style>
  </head>
  <body>
    <header>
      <h1>Campeones para Coquimbo</h1>

      <nav>
        {# Inicio: si est√° logueado, manda al panel por rol; si no, a la home p√∫blica #}
        {% if request.user.is_authenticated %}
          <a href="{% url 'usuarios:panel' %}">üè† Inicio</a>
        {% else %}
          <a href="{% url 'core:home' %}">üè† Inicio</a>
        {% endif %}

        {% if request.user.is_authenticated %}
          <span style="margin-left:12px;">Hola, {{ request.user.username }}</span>

          {# --- Enlaces por rol --- #}
          {% with t=request.user.tipo_usuario|default_if_none:''|upper %}
            {% if t == 'APOD' %}
              <a href="{% url 'apoderado:dashboard' %}">Mi Panel (Apoderado)</a>
            {% endif %}

            {# Equipo Multidisciplinario (PMUL y variantes) #}
            {% if t == 'PMUL' or t == 'EMUL' or t == 'MULTI' or t == 'PROF_MULTIDISCIPLINARIO' or t == 'PROFESIONAL_MULTIDISCIPLINARIO' or t == 'PROFESIONAL' or t == 'EQUIPO_MULTIDISCIPLINARIO' %}
              {# si tienes una vista de panel para PMUL, c√°mbiala aqu√≠; por ahora apunto al listado de slots #}
              <a href="{% url 'pmul:slots_list' %}">Equipo Multidisciplinario</a>
            {% endif %}

            {% if t == 'ADMIN' %}
              <a href="{% url 'usuarios:panel_admin' %}">Admin</a>
            {% endif %}

            {% if t == 'COORD' %}
              <a href="{% url 'usuarios:panel_coordinador' %}">Panel Coordinador</a>
            {% endif %}

           {% if t == 'PROF' %}
             <a href="{% url 'usuarios:panel_profesor' %}">Panel Profesor</a>
            {% endif %}

            {% if t == 'ATLE' %}
              <a href="{% url 'usuarios:panel_atleta' %}">Mi Panel (Atleta)</a>
            {% endif %}
          {% endwith %}

          <a href="{% url 'usuarios:logout' %}">Salir</a>
        {% else %}
          <a href="{% url 'usuarios:login_rut' %}">üîê Iniciar sesi√≥n</a>
        {% endif %}

        {# Informativas p√∫blicas #}
        <a href="{% url 'core:comunicados_list' %}">Comunicados</a>
        <a href="{% url 'core:quienes' %}">Con√≥cenos</a>
        <a href="{% url 'core:procesos' %}">Procesos de inscripci√≥n</a>
        <a href="{% url 'core:deportes' %}">Deportes y recintos</a>
        <a href="{% url 'core:equipo' %}">Equipo Multidisciplinario</a>
      </nav>
    </header>

    <div class="bar">
      <a class="btn" href="javascript:history.back()">‚Üê Atr√°s</a>
      {% if request.user.is_authenticated %}
        <a class="btn" href="{% url 'usuarios:panel' %}">üè† Inicio</a>
      {% else %}
        <a class="btn" href="{% url 'core:home' %}">üè† Inicio</a>
      {% endif %}
      {% if next_url %}
        <a class="btn" href="{{ next_url }}">Siguiente ‚Üí</a>
      {% endif %}
    </div>

    <main>
      <h2>{% block header %}{% endblock %}</h2>

      {# --- Bloque de mensajes --- #}
      {% if messages %}
        <ul class="messages">
          {% for m in messages %}
            <li class="{{ m.tags }}">{{ m }}</li>
          {% endfor %}
        </ul>
      {% endif %}

      {% block content %}{% endblock %}
    </main>

    <footer style="margin-top:24px; color:#555; font-size:14px;">
      <hr style="border:none;border-top:1px solid #eee;margin:16px 0;">
      <div style="display:flex; flex-wrap:wrap; gap:16px; align-items:center; justify-content:space-between;">
        <div>
          <strong>Redes sociales:</strong>
          Facebook: <em>Campeones para Coquimbo</em> ¬∑
          Instagram: <em>@CampeonesParaCoquimbo</em>
        </div>
        <div>Municipalidad de Coquimbo</div>
      </div>
    </footer>
  </body>
</html>
