{% extends "base/plantilla.html" %}
{% block title %}Planificación semanal{% endblock %}
{% block header %}Planificación semanal{% endblock %}

{% block extra_css %}
<style>
  .page-head{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:.75rem}
  .filters{display:grid;grid-template-columns:180px auto auto;gap:10px;align-items:end}
  @media (max-width:768px){.filters{grid-template-columns:1fr}}
</style>
{% endblock %}

{% block content %}

  <!-- Filtros + navegación de semanas -->
  <form method="get" class="card p-3 mb-3">
    <div class="filters">
      <div>
        <label class="form-label mb-1">Semana</label>
        <input type="date" name="semana" value="{{ semana }}" class="form-control">
      </div>
      <div style="display:flex;gap:8px;flex-wrap:wrap">
        <a class="btn btn-outline-secondary" href="?semana={{ semana_anterior }}">« Semana anterior</a>
        <a class="btn btn-outline-secondary" href="?semana={{ semana_siguiente }}">Semana siguiente »</a>
      </div>
      <div style="display:flex;gap:8px;justify-content:flex-end">
        <button class="btn btn-primary" type="submit">Filtrar</button>
      </div>
    </div>
  </form>

  <p class="text-muted">Del <strong>{{ desde|date:"d/m" }}</strong> al <strong>{{ hasta|date:"d/m" }}</strong>.</p>

  {% if items %}
    <div class="card shadow-sm">
      <div class="card-body p-0">
        <div class="table-responsive">
          <table class="table table-hover mb-0">
            <thead class="thead-light">
              <tr>
                <th>Curso</th>
                <th>Sede</th>
                <th>Disciplina</th>
                <th>Archivo</th>
                <th>Comentarios</th>
              </tr>
            </thead>
            <tbody>
              {% for p in items %}
                <tr>
                  <td>{{ p.curso.nombre }}</td>
                  <td>{{ p.curso.sede.nombre }}</td>
                  <td>{{ p.curso.disciplina.nombre }}</td>
                  <td>
                    {% if p.archivo %}
                      <a href="{{ p.archivo.url }}" class="btn btn-sm btn-outline-primary">Descargar</a>
                    {% else %}
                      —
                    {% endif %}
                  </td>
                  <td>{{ p.comentarios|default:"—" }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  {% else %}
    <div class="alert alert-info mb-0">No hay planificaciones publicadas esta semana.</div>
  {% endif %}

{% endblock %}
