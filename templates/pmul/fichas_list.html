{% extends "base/plantilla.html" %}
{% block title %}Fichas cl√≠nicas{% endblock %}
{% block header %}Fichas cl√≠nicas{% endblock %}

{% block extra_css %}
<style>
  .actions-bar{ display:flex; justify-content:flex-end; }
  .badge-soft{
    display:inline-block; padding:.15rem .45rem; font-size:.82rem; border-radius:.5rem;
    background:#f1f5f9; border:1px solid #e5e7eb; color:#334155;
  }
  .table td, .table th{ vertical-align:middle; }
  .muted{ color:#6b7280; }
</style>
{% endblock %}

{% block content %}
<div class="mb-2 actions-bar">
  <a class="btn btn-primary" href="{% url 'pmul:ficha_new' %}">Nueva ficha</a>
</div>

<div class="table-responsive">
  <table class="table table-striped mb-0">
    <thead>
      <tr>
        <th style="min-width:110px;">Fecha</th>
        <th>Atleta</th>
        <th>Previsi√≥n</th>
        <th>Especialidad</th>
        <th>Motivo</th>
        <th>Estado</th>
        <th style="width:1%; white-space:nowrap;">Acci√≥n</th>
      </tr>
    </thead>
    <tbody>
      {% for f in items %}
        <tr>
          <td>{{ f.fecha|date:"d/m/Y" }}</td>
          <td>{{ f.paciente.nombres }} {{ f.paciente.apellidos }}</td>
          <td>
            {% if f.paciente.get_prevision_display %}
              <span class="badge-soft">{{ f.paciente.get_prevision_display }}</span>
            {% else %}
              <span class="muted">‚Äî</span>
            {% endif %}
          </td>
          <td><span class="badge-soft">{{ f.get_especialidad_display }}</span></td>
          <td>{{ f.motivo|default:"‚Äî" }}</td>
          <td>{{ f.get_estado_display }}</td>
          <td>
            <a class="btn btn-sm btn-outline-primary" href="{% url 'pmul:ficha_detail' f.id %}">üëÅÔ∏è Ver</a>
          </td>
        </tr>
      {% empty %}
        <tr>
          <td colspan="7" class="muted">Sin fichas.</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
