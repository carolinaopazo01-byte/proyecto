{% extends "base/base_reportes.html" %}
{% load static %}

{% block header_subtitle %}
Indicadores CPC â€“ Asistencias
{% endblock %}

{% block report_content %}
<form method="get" class="filters mb-4" style="display:flex; flex-wrap:wrap; gap:15px; align-items:end;">
  <div>
    <label><strong>Sede:</strong></label>
    <select name="sede" class="form-control">
      <option value="">Todas</option>
      {% for s in sedes %}
        <option value="{{ s.id }}" {% if s.id|stringformat:"s" == sede_id %}selected{% endif %}>{{ s.nombre }}</option>
      {% endfor %}
    </select>
  </div>

  <div>
    <label><strong>Disciplina:</strong></label>
    <select name="disciplina" class="form-control">
      <option value="">Todas</option>
      {% for d in disciplinas %}
        <option value="{{ d.id }}" {% if d.id|stringformat:"s" == dep_id %}selected{% endif %}>{{ d.nombre }}</option>
      {% endfor %}
    </select>
  </div>

  <button type="submit" class="btn btn-primary">
    <i class="fa-solid fa-filter"></i> Filtrar
  </button>
</form>

<div style="display:flex; justify-content:end; gap:10px; margin-bottom:20px;">
  <a href="{% url 'core:exportar_excel_asistencias' %}?sede={{ sede_id }}&disciplina={{ dep_id }}" class="btn btn-success">
    <i class="fa-solid fa-file-excel"></i> Excel
  </a>
  <a href="{% url 'core:exportar_kpi_asistencias' %}?sede={{ sede_id }}&disciplina={{ dep_id }}" class="btn btn-danger">
    <i class="fa-solid fa-file-pdf"></i> PDF
  </a>
</div>

<div class="kpi-grid mb-6">
  {% for kpi in kpi_asistencias %}
  <div class="kpi-card">
    <div class="kpi-icon" style="background:#10b981;"><i class="fas {{ kpi.icon }}"></i></div>
    <div class="kpi-info"><h4>{{ kpi.value }}</h4><p>{{ kpi.label }}</p></div>
  </div>
  {% empty %}
  <p>No hay datos de asistencia.</p>
  {% endfor %}
</div>
{% endblock %}
