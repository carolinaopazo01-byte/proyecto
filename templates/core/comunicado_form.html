{% extends "base/plantilla.html" %}
{% load static %}
{% block title %}{{ is_edit|yesno:"Editar comunicado,Crear comunicado" }}{% endblock %}

{% block content %}
<div class="container-fluid cpc-safe" style="max-width:760px;">
  <h4 class="mb-3">{{ is_edit|yesno:"Editar comunicado,Nuevo comunicado" }}</h4>

  {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
  {% endif %}

  <form method="post" novalidate>
    {% csrf_token %}

    <!-- Título -->
    <div class="mb-3">
      <label for="{{ form.titulo.id_for_label }}">Título</label>
      {{ form.titulo }}
      {% if form.titulo.errors %}
        <div class="text-danger small">{{ form.titulo.errors }}</div>
      {% endif %}
    </div>

    <!-- Cuerpo -->
    <div class="mb-3">
      <label for="{{ form.cuerpo.id_for_label }}">Cuerpo del comunicado</label>
      {{ form.cuerpo }}
      {% if form.cuerpo.errors %}
        <div class="text-danger small">{{ form.cuerpo.errors }}</div>
      {% endif %}
    </div>

    <!-- Audiencia -->
    <div class="mb-3">
      <label><strong>Audiencia</strong></label>

      <!-- PROFESORES -->
      <div class="form-check mb-1">
        <label class="form-check-label">
          <input type="checkbox" name="audiencia_codigos" value="PROF"
                 class="form-check-input"
                 {% if 'PROF' in form.instance.get_audiencia_codigos %}checked{% endif %}>
          Profesores / Entrenadores
        </label>
      </div>

      <!-- PROFESIONAL MULTIDISCIPLINARIO -->
      <div class="form-check mb-1">
        <label class="form-check-label">
          <input type="checkbox" name="audiencia_codigos" value="PMUL"
                 class="form-check-input"
                 {% if 'PMUL' in form.instance.get_audiencia_codigos %}checked{% endif %}>
          Profesional Multidisciplinario
        </label>
      </div>

      <!-- DEPORTISTA / APODERADO -->
      <div class="form-check mb-1">
        <label class="form-check-label">
          <input type="checkbox" name="audiencia_codigos" value="ATAP"
                 class="form-check-input"
                 {% if 'ATAP' in form.instance.get_audiencia_codigos %}checked{% endif %}>
          Deportista / Apoderado
        </label>
      </div>

      <!-- PÚBLICO -->
      <div class="form-check mb-1">
        <label class="form-check-label">
          <input type="checkbox" name="audiencia_codigos" value="PUBL"
                 class="form-check-input"
                 {% if 'PUBL' in form.instance.get_audiencia_codigos %}checked{% endif %}>
          Público (visible sin iniciar sesión)
        </label>
      </div>

      <small class="form-text text-muted">
        Puedes marcar una o más audiencias (por ejemplo: Público + Profesores).
      </small>
    </div>

    <!-- Botones -->
    <div class="d-flex gap-2">
      <button class="btn btn-primary" type="submit">
        <i class="fas fa-save mr-1"></i> Guardar
      </button>
      <a class="btn btn-outline-secondary" href="{% url 'core:comunicados_list' %}">Cancelar</a>
    </div>
  </form>
</div>
{% endblock %}
